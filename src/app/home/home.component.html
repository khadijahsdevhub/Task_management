<section class="container-fluid">
  <section class="wrapper p-3 mx-auto">
    <div class="row justify-content-between gap-3 align-items-center">
      <div class="col-12 col-lg-4 col-md-6 d-flex flex-column">
        <div class="profile d-flex align-items-center gap-3">
          <img
            src="../../assets/images/user1.jpeg"
            alt="user-image"
            class="profile-img"
          />
          <div>
            <h6 class="">
              Hi, <span class="fw-bold"> {{ username }} </span>
            </h6>
          </div>
        </div>
        <div class="row my-3">
          <h5>Monday, 12th Jan 2025</h5>
        </div>
      </div>

      <div class="progress col-12 col-lg-8 col-md-6">
        <div class="mr-3">
          <h6>Your today's task is almost done!</h6>
          <button class="mt-3 custom-btn" (click)="goToTasks()">
            View all tasks
          </button>
        </div>
        <circle-progress
          [percent]="progress"
          [radius]="60"
          [outerStrokeWidth]="10"
          [innerStrokeWidth]="3"
          [outerStrokeColor]="'#fff'"
          [innerStrokeColor]="'#d7c9f9'"
          [animation]="true"
          [animationDuration]="300"
          [showTitle]="true"
          [titleColor]="'#fff'"
          [showUnits]="true"
          [unitsColor]="'#fff'"
          [showSubtitle]="true"
          [subtitleColor]="'#fff'"
          [showBackground]="true"
        >
        </circle-progress>
      </div>
    </div>
  </section>
  <section class="container my-4">
    <div class="d-flex row justify-content-between align-items-center">
      <h4 class="col-12 col-lg-3">Today's Tasks</h4>
      <div class="col d-flex justify-content-between align-items-center">
        <div class="searchGroup">
          <i class="fa-solid fa-magnifying-glass"></i>
          <input
            type="text"
            [(ngModel)]="searchTerm"
            placeholder="Search tasks..."
            (ngModelChange)="searchTasks($event)"
          />
        </div>

        <div class="filters">
          <select
            id="taskPriority"
            class="filter cursor mx-3"
            (ngModelChange)="filterTasksByPriority($event)"
            [(ngModel)]="selectedPriority"
            name="priority"
          >
            <option value="All" selected>Filter</option>
            <option
              class=""
              *ngFor="let priority of priorities"
              [value]="priority.name"
            >
              {{ priority.name }}
            </option>
          </select>
        </div>
      </div>
    </div>

    <app-categories
      (filterTasks)="filterTasksByCategory($event)"
      [selectedCategory]="selectedCategory"
    >
    </app-categories>

    <div>
      @if(filteredTaskList.length < 1 ) {
      <div
        class="d-flex justify-content-center align-items-center flex-column gap-3 p-3"
      >
        <img src="/assets/images/no-results.png" />
        @if (selectedCategory == "All") {
        <h2>No Task Found</h2>
        <div class="d-flex gap-4">
          <button class="btn-primary" (click)="goToTasks()">
            View All Task
          </button>
          <button class="btn-outline-primary" (click)="openModal()">
            Add a New Task
          </button>
        </div>
        } @else {
        <h2>No {{ selectedCategory }} Task Found</h2>
        <div class="d-flex gap-4">
          <button class="btn-primary" (click)="goToTasks()">
            View All Task
          </button>
          <button class="btn-outline-primary" (click)="openModal()">
            Add a New Task
          </button>
        </div>
        }
      </div>
      } @else {
      <app-todolists
        [taskLists]="filteredTaskList"
        [hasCompletedTask]="hasCompletedTasks()"
        (editTask)="openEditTask($event)"
        (deleteTask)="deleteTask($event)"
        (toggleComplete)="onToggleComplete($event)"
        (toggleViewdetails)="toggleTaskDetails($event)"
      ></app-todolists>
      }
    </div>
  </section>

  <button class="add-task cursor" (click)="openModal()">
    <span>
      <i class="fa-solid fa-plus"></i>
    </span>
  </button>
</section>
@if (isModalOpen) {
<app-add-todo
  (closemodal)="closeModal()"
  [isEditMode]="editMode"
  [taskToEdit]="selectedTask"
></app-add-todo>
}
